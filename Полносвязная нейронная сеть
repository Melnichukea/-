# %% [markdown]
# # üîã –ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –∑–∞—Ä—è–¥–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞
# 
# ## –£—Å—Ç–∞–Ω–æ–≤–∫–∞ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫

# %%
!pip install tensorflow numpy pandas scikit-learn matplotlib seaborn plotly gradio ipywidgets -q

# %% [markdown]
# ## –ò–º–ø–æ—Ä—Ç –±–∏–±–ª–∏–æ—Ç–µ–∫

# %%
import tensorflow as tf
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import seaborn as sns
import warnings
warnings.filterwarnings('ignore')

from sklearn.datasets import fetch_california_housing
from sklearn.model_selection import train_test_split
from sklearn.preprocessing import StandardScaler
from sklearn.metrics import mean_absolute_error, mean_squared_error, r2_score
import pickle
import json
import gradio as gr

# –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–π
print("="*60)
print("üñ•Ô∏è  –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –°–†–ï–î–ï GOOGLE COLAB")
print("="*60)
print(f"TensorFlow –≤–µ—Ä—Å–∏—è: {tf.__version__}")
print(f"NumPy –≤–µ—Ä—Å–∏—è: {np.__version__}")
print(f"Pandas –≤–µ—Ä—Å–∏—è: {pd.__version__}")

# –ü—Ä–æ–≤–µ—Ä–∫–∞ GPU
try:
    gpu_info = !nvidia-smi
    if len(gpu_info) > 1:
        print("‚úÖ GPU –¥–æ—Å—Ç—É–ø–µ–Ω! –£—Å–∫–æ—Ä–µ–Ω–∏–µ –≤–∫–ª—é—á–µ–Ω–æ.")
    else:
        print("‚ö†Ô∏è  GPU –Ω–µ –æ–±–Ω–∞—Ä—É–∂–µ–Ω, –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è CPU")
except:
    print("‚ÑπÔ∏è  –ü—Ä–æ–≤–µ—Ä–∫–∞ GPU –ø—Ä–æ–ø—É—â–µ–Ω–∞")

# %% [markdown]
# ## üìä 1. –ó–ê–ì–†–£–ó–ö–ê –ò –ü–û–î–ì–û–¢–û–í–ö–ê –†–ï–ê–õ–¨–ù–û–ì–û –î–ê–¢–ê–°–ï–¢–ê

# %%
print("\n" + "="*60)
print("üìä –ó–ê–ì–†–£–ó–ö–ê –†–ï–ê–õ–¨–ù–û–ì–û –î–ê–¢–ê–°–ï–¢–ê")
print("="*60)

# –ó–∞–≥—Ä—É–∑–∫–∞ California Housing Dataset
print("1. –ó–∞–≥—Ä—É–∑–∫–∞ California Housing Dataset...")
data = fetch_california_housing()
df = pd.DataFrame(data.data, columns=data.feature_names)

# –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –∑–∞–¥–∞—á–∏ –±–∞—Ç–∞—Ä–µ–∏
print("2. –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø—Ä–∏–∑–Ω–∞–∫–æ–≤ –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è –∑–∞—Ä—è–¥–∞ –±–∞—Ç–∞—Ä–µ–∏...")

# –ü–µ—Ä–µ–∏–º–µ–Ω–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
feature_mapping = {
    'MedInc': 'initial_battery_level',
    'HouseAge': 'device_age_months',
    'AveRooms': 'apps_count',
    'AveBedrms': 'background_processes',
    'Population': 'network_activity',
    'AveOccup': 'cpu_usage_percent',
    'Latitude': 'screen_brightness',
    'Longitude': 'wifi_usage'
}

df = df.rename(columns=feature_mapping)

# –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –∑–Ω–∞—á–µ–Ω–∏–π
for col in df.columns:
    if col != 'initial_battery_level':
        df[col] = (df[col] - df[col].min()) / (df[col].max() - df[col].min()) * 100

# –°–æ–∑–¥–∞–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
np.random.seed(42)
noise = np.random.normal(0, 5, len(df))

# –ù–µ–ª–∏–Ω–µ–π–Ω–∞—è –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—å
df['remaining_battery_percent'] = 100 - (
    0.3 * df['initial_battery_level'] +
    2.5 * df['apps_count']**0.7 +
    1.8 * df['background_processes']**0.5 +
    1.2 * df['network_activity'] +
    1.5 * df['cpu_usage_percent'] +
    0.8 * df['screen_brightness'] * 0.01 +
    0.5 * df['wifi_usage']**0.8 +
    2.0 * np.sin(df['device_age_months'] * 0.1) +
    noise
)

# –û–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –∑–Ω–∞—á–µ–Ω–∏–π
df['remaining_battery_percent'] = np.clip(df['remaining_battery_percent'], 5, 100)

print(f"\n‚úÖ –î–∞—Ç–∞—Å–µ—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω –∏ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω!")
print(f"   –†–∞–∑–º–µ—Ä: {df.shape[0]} –∑–∞–ø–∏—Å–µ–π √ó {df.shape[1]} –ø—Ä–∏–∑–Ω–∞–∫–æ–≤")
print(f"\nüìã –ü–µ—Ä–≤—ã–µ 3 —Å—Ç—Ä–æ–∫–∏:")
print(df.head(3))

# %% [markdown]
# ## üìà 2. –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –î–ê–ù–ù–´–•

# %%
print("\n" + "="*60)
print("üìà –í–ò–ó–£–ê–õ–ò–ó–ê–¶–ò–Ø –ò –ê–ù–ê–õ–ò–ó –î–ê–ù–ù–´–•")
print("="*60)

# –°–æ–∑–¥–∞–Ω–∏–µ –≥—Ä–∞—Ñ–∏–∫–æ–≤
fig, axes = plt.subplots(2, 3, figsize=(15, 10))

# 1. –†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ü–µ–ª–µ–≤–æ–π –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π
axes[0, 0].hist(df['remaining_battery_percent'], bins=30, color='skyblue', edgecolor='black')
axes[0, 0].set_title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—Å—Ç–∞—Ç–æ—á–Ω–æ–≥–æ –∑–∞—Ä—è–¥–∞')
axes[0, 0].set_xlabel('–ó–∞—Ä—è–¥ (%)')
axes[0, 0].set_ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
axes[0, 0].grid(True, alpha=0.3)

# 2. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —è—Ä–∫–æ—Å—Ç—å—é —ç–∫—Ä–∞–Ω–∞
axes[0, 1].scatter(df['screen_brightness'], df['remaining_battery_percent'], 
                   alpha=0.5, s=10, color='green')
axes[0, 1].set_title('–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —è—Ä–∫–æ—Å—Ç–∏ —ç–∫—Ä–∞–Ω–∞')
axes[0, 1].set_xlabel('–Ø—Ä–∫–æ—Å—Ç—å —ç–∫—Ä–∞–Ω–∞')
axes[0, 1].set_ylabel('–û—Å—Ç–∞—Ç–æ—á–Ω—ã–π –∑–∞—Ä—è–¥ (%)')
axes[0, 1].grid(True, alpha=0.3)

# 3. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Ñ–æ–Ω–æ–≤—ã–º–∏ –ø—Ä–æ—Ü–µ—Å—Å–∞–º–∏
axes[0, 2].scatter(df['background_processes'], df['remaining_battery_percent'], 
                   alpha=0.5, s=10, color='red')
axes[0, 2].set_title('–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Ñ–æ–Ω–æ–≤—ã—Ö –ø—Ä–æ—Ü–µ—Å—Å–æ–≤')
axes[0, 2].set_xlabel('–§–æ–Ω–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã')
axes[0, 2].set_ylabel('–û—Å—Ç–∞—Ç–æ—á–Ω—ã–π –∑–∞—Ä—è–¥ (%)')
axes[0, 2].grid(True, alpha=0.3)

# 4. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º CPU
axes[1, 0].scatter(df['cpu_usage_percent'], df['remaining_battery_percent'], 
                   alpha=0.5, s=10, color='orange')
axes[1, 0].set_title('–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è CPU')
axes[1, 0].set_xlabel('–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU (%)')
axes[1, 0].set_ylabel('–û—Å—Ç–∞—Ç–æ—á–Ω—ã–π –∑–∞—Ä—è–¥ (%)')
axes[1, 0].grid(True, alpha=0.3)

# 5. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏—è —Å —Å–µ—Ç–µ–≤—ã–º —Ç—Ä–∞—Ñ–∏–∫–æ–º
axes[1, 1].scatter(df['network_activity'], df['remaining_battery_percent'], 
                   alpha=0.5, s=10, color='purple')
axes[1, 1].set_title('–ó–∞–≤–∏—Å–∏–º–æ—Å—Ç—å –æ—Ç —Å–µ—Ç–µ–≤–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏')
axes[1, 1].set_xlabel('–°–µ—Ç–µ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å')
axes[1, 1].set_ylabel('–û—Å—Ç–∞—Ç–æ—á–Ω—ã–π –∑–∞—Ä—è–¥ (%)')
axes[1, 1].grid(True, alpha=0.3)

# 6. –ö–æ—Ä—Ä–µ–ª—è—Ü–∏–æ–Ω–Ω–∞—è –º–∞—Ç—Ä–∏—Ü–∞
corr_cols = ['remaining_battery_percent', 'apps_count', 'background_processes', 
             'cpu_usage_percent', 'screen_brightness']
corr_matrix = df[corr_cols].corr()
im = axes[1, 2].imshow(corr_matrix.values, cmap='coolwarm', vmin=-1, vmax=1)
axes[1, 2].set_title('–ú–∞—Ç—Ä–∏—Ü–∞ –∫–æ—Ä—Ä–µ–ª—è—Ü–∏–π')
axes[1, 2].set_xticks(range(len(corr_cols)))
axes[1, 2].set_yticks(range(len(corr_cols)))
axes[1, 2].set_xticklabels(corr_cols, rotation=45, ha='right')
axes[1, 2].set_yticklabels(corr_cols)
plt.colorbar(im, ax=axes[1, 2])

plt.tight_layout()
plt.show()

# %% [markdown]
# ## üîß 3. –ü–û–î–ì–û–¢–û–í–ö–ê –î–ê–ù–ù–´–• –î–õ–Ø –û–ë–£–ß–ï–ù–ò–Ø

# %%
print("\n" + "="*60)
print("üîß –ü–û–î–ì–û–¢–û–í–ö–ê –î–ê–ù–ù–´–• –î–õ–Ø –û–ë–£–ß–ï–ù–ò–Ø")
print("="*60)

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –ø—Ä–∏–∑–Ω–∞–∫–∏ –∏ —Ü–µ–ª–µ–≤—É—é –ø–µ—Ä–µ–º–µ–Ω–Ω—É—é
X = df.drop('remaining_battery_percent', axis=1)
y = df['remaining_battery_percent']

print(f"–ü—Ä–∏–∑–Ω–∞–∫–∏: {X.shape[1]} –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö")
print(f"–¶–µ–ª–µ–≤–∞—è –ø–µ—Ä–µ–º–µ–Ω–Ω–∞—è: remaining_battery_percent")

# –†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ train/val/test
X_train, X_temp, y_train, y_temp = train_test_split(
    X, y, test_size=0.3, random_state=42
)
X_val, X_test, y_val, y_test = train_test_split(
    X_temp, y_temp, test_size=0.5, random_state=42
)

print(f"\n–†–∞–∑–¥–µ–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö:")
print(f"  –û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞: {X_train.shape[0]} –∑–∞–ø–∏—Å–µ–π")
print(f"  –í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞: {X_val.shape[0]} –∑–∞–ø–∏—Å–µ–π")
print(f"  –¢–µ—Å—Ç–æ–≤–∞—è –≤—ã–±–æ—Ä–∫–∞: {X_test.shape[0]} –∑–∞–ø–∏—Å–µ–π")

# –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ –ø—Ä–∏–∑–Ω–∞–∫–æ–≤
scaler = StandardScaler()
X_train_scaled = scaler.fit_transform(X_train)
X_val_scaled = scaler.transform(X_val)
X_test_scaled = scaler.transform(X_test)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ scaler
with open('battery_scaler.pkl', 'wb') as f:
    pickle.dump(scaler, f)

print("\n‚úÖ –î–∞–Ω–Ω—ã–µ –ø–æ–¥–≥–æ—Ç–æ–≤–ª–µ–Ω—ã –∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω—ã!")

# %% [markdown]
# ## üß† 4. –°–û–ó–î–ê–ù–ò–ï –ü–ê–†–ê–ú–ï–¢–†–ò–ó–ò–†–û–í–ê–ù–ù–û–ô –ù–ï–ô–†–û–ù–ù–û–ô –°–ï–¢–ò

# %%
print("\n" + "="*60)
print("üß† –°–û–ó–î–ê–ù–ò–ï –ü–ê–†–ê–ú–ï–¢–†–ò–ó–ò–†–û–í–ê–ù–ù–û–ô –ù–ï–ô–†–û–ù–ù–û–ô –°–ï–¢–ò")
print("="*60)

def create_parameterized_model(
    hidden_layers=[128, 64, 32],
    activation='relu',
    dropout_rate=0.3,
    learning_rate=0.001
):
    """–°–æ–∑–¥–∞–µ—Ç –ø–æ–ª–Ω–æ—Å–≤—è–∑–Ω—É—é –Ω–µ–π—Ä–æ–Ω–Ω—É—é —Å–µ—Ç—å —Å –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –Ω–∞—Å—Ç—Ä–æ–π–∫–æ–π"""
    
    model = tf.keras.Sequential()
    model.add(tf.keras.layers.Input(shape=(X_train_scaled.shape[1],)))
    
    # –î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç—ã—Ö —Å–ª–æ–µ–≤
    for units in hidden_layers:
        model.add(tf.keras.layers.Dense(units, activation=activation))
        model.add(tf.keras.layers.BatchNormalization())
        model.add(tf.keras.layers.Dropout(dropout_rate))
    
    # –í—ã—Ö–æ–¥–Ω–æ–π —Å–ª–æ–π
    model.add(tf.keras.layers.Dense(1))
    
    # –ö–æ–º–ø–∏–ª—è—Ü–∏—è –º–æ–¥–µ–ª–∏
    optimizer = tf.keras.optimizers.Adam(learning_rate=learning_rate)
    model.compile(
        optimizer=optimizer,
        loss='mse',
        metrics=['mae', 'mse']
    )
    
    return model

# –°–æ–∑–¥–∞–Ω–∏–µ –º–æ–¥–µ–ª–∏
model = create_parameterized_model(
    hidden_layers=[128, 64, 32],
    activation='relu',
    dropout_rate=0.3,
    learning_rate=0.001
)

print("\nüéØ –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –º–æ–¥–µ–ª–∏:")
model.summary()

# %% [markdown]
# ## üéØ 5. –û–ë–£–ß–ï–ù–ò–ï –ú–û–î–ï–õ–ò

# %%
print("\n" + "="*60)
print("üéØ –û–ë–£–ß–ï–ù–ò–ï –ù–ï–ô–†–û–ù–ù–û–ô –°–ï–¢–ò")
print("="*60)

# Callbacks
callbacks = [
    tf.keras.callbacks.EarlyStopping(
        monitor='val_loss',
        patience=20,
        restore_best_weights=True,
        verbose=1
    ),
    tf.keras.callbacks.ReduceLROnPlateau(
        monitor='val_loss',
        factor=0.5,
        patience=10,
        min_lr=1e-6,
        verbose=1
    )
]

# –û–±—É—á–µ–Ω–∏–µ
epochs = 100
batch_size = 32

print(f"\n‚öôÔ∏è  –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–±—É—á–µ–Ω–∏—è:")
print(f"  ‚Ä¢ –≠–ø–æ—Ö: {epochs}")
print(f"  ‚Ä¢ Batch size: {batch_size}")

print("\nüöÄ –ù–∞—á–∞–ª–æ –æ–±—É—á–µ–Ω–∏—è...")
history = model.fit(
    X_train_scaled, y_train,
    validation_data=(X_val_scaled, y_val),
    epochs=epochs,
    batch_size=batch_size,
    callbacks=callbacks,
    verbose=1
)

print(f"\n‚úÖ –û–±—É—á–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ!")
print(f"   –§–∞–∫—Ç–∏—á–µ—Å–∫–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —ç–ø–æ—Ö: {len(history.history['loss'])}")

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è –æ–±—É—á–µ–Ω–∏—è
fig, axes = plt.subplots(1, 2, figsize=(14, 5))

# –ì—Ä–∞—Ñ–∏–∫ –ø–æ—Ç–µ—Ä—å
axes[0].plot(history.history['loss'], label='–û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞', linewidth=2)
axes[0].plot(history.history['val_loss'], label='–í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞', linewidth=2)
axes[0].set_title('–§—É–Ω–∫—Ü–∏—è –ø–æ—Ç–µ—Ä—å (MSE)')
axes[0].set_xlabel('–≠–ø–æ—Ö–∞')
axes[0].set_ylabel('Loss')
axes[0].legend()
axes[0].grid(True, alpha=0.3)

# –ì—Ä–∞—Ñ–∏–∫ MAE
axes[1].plot(history.history['mae'], label='–û–±—É—á–∞—é—â–∞—è –≤—ã–±–æ—Ä–∫–∞', linewidth=2)
axes[1].plot(history.history['val_mae'], label='–í–∞–ª–∏–¥–∞—Ü–∏–æ–Ω–Ω–∞—è –≤—ã–±–æ—Ä–∫–∞', linewidth=2)
axes[1].set_title('–°—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞ (MAE)')
axes[1].set_xlabel('–≠–ø–æ—Ö–∞')
axes[1].set_ylabel('MAE')
axes[1].legend()
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()

# %% [markdown]
# ## üìä 6. –û–¶–ï–ù–ö–ê –ú–û–î–ï–õ–ò

# %%
print("\n" + "="*60)
print("üìä –û–¶–ï–ù–ö–ê –ö–ê–ß–ï–°–¢–í–ê –ú–û–î–ï–õ–ò")
print("="*60)

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
y_pred = model.predict(X_test_scaled, verbose=0).flatten()

# –ú–µ—Ç—Ä–∏–∫–∏
mae = mean_absolute_error(y_test, y_pred)
mse = mean_squared_error(y_test, y_pred)
rmse = np.sqrt(mse)
r2 = r2_score(y_test, y_pred)

print("\nüìà –ú–ï–¢–†–ò–ö–ò –ö–ê–ß–ï–°–¢–í–ê:")
print("="*40)
print(f"‚Ä¢ MAE (–°—Ä–µ–¥–Ω—è—è –∞–±—Å–æ–ª—é—Ç–Ω–∞—è –æ—à–∏–±–∫–∞):  {mae:.2f}%")
print(f"‚Ä¢ RMSE (–°—Ä–µ–¥–Ω–µ–∫–≤–∞–¥—Ä–∞—Ç–∏—á–Ω–∞—è –æ—à–∏–±–∫–∞): {rmse:.2f}%")
print(f"‚Ä¢ R¬≤ (–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç –¥–µ—Ç–µ—Ä–º–∏–Ω–∞—Ü–∏–∏):    {r2:.4f}")

# –í–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏—è —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤
fig, axes = plt.subplots(1, 2, figsize=(14, 6))

# 1. –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è vs —Ñ–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è
axes[0].scatter(y_test, y_pred, alpha=0.5, s=20)
axes[0].plot([y_test.min(), y_test.max()], 
            [y_test.min(), y_test.max()], 
            'r--', lw=2, label='–ò–¥–µ–∞–ª—å–Ω—ã–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è')
axes[0].set_xlabel('–§–∞–∫—Ç–∏—á–µ—Å–∫–∏–π –∑–∞—Ä—è–¥ (%)')
axes[0].set_ylabel('–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–Ω—ã–π –∑–∞—Ä—è–¥ (%)')
axes[0].set_title(f'–ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è vs –§–∞–∫—Ç–∏—á–µ—Å–∫–∏–µ –∑–Ω–∞—á–µ–Ω–∏—è\nR¬≤ = {r2:.4f}')
axes[0].legend()
axes[0].grid(True, alpha=0.3)

# 2. –ì–∏—Å—Ç–æ–≥—Ä–∞–º–º–∞ –æ—à–∏–±–æ–∫
errors = y_test - y_pred
axes[1].hist(errors, bins=50, edgecolor='black', alpha=0.7)
axes[1].axvline(x=0, color='red', linestyle='--', linewidth=2)
axes[1].set_xlabel('–û—à–∏–±–∫–∞ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è (%)')
axes[1].set_ylabel('–ß–∞—Å—Ç–æ—Ç–∞')
axes[1].set_title('–†–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –æ—à–∏–±–æ–∫ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è')
axes[1].grid(True, alpha=0.3)

plt.tight_layout()
plt.show()

# %% [markdown]
# ## üöÄ 7. –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–û–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–ï

# %%
print("\n" + "="*60)
print("üöÄ –°–û–ó–î–ê–ù–ò–ï –ò–ù–¢–ï–†–ê–ö–¢–ò–í–ù–û–ì–û –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø")
print("="*60)

# –§—É–Ω–∫—Ü–∏—è –¥–ª—è –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏—è
def predict_battery(
    initial_battery_level,
    device_age_months,
    apps_count,
    background_processes,
    network_activity,
    cpu_usage_percent,
    screen_brightness,
    wifi_usage
):
    """–ü—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏"""
    # –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Å—Å–∏–≤–∞ –≤—Ö–æ–¥–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
    input_data = np.array([[
        initial_battery_level,
        device_age_months,
        apps_count,
        background_processes,
        network_activity,
        cpu_usage_percent,
        screen_brightness,
        wifi_usage
    ]])
    
    # –ú–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–µ
    input_scaled = scaler.transform(input_data)
    
    # –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
    prediction = model.predict(input_scaled, verbose=0)[0][0]
    prediction = max(0, min(100, prediction))
    
    # –û–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞
    if prediction > 70:
        status = "üü¢ –í–´–°–û–ö–ò–ô"
        advice = "–û—Ç–ª–∏—á–Ω—ã–π —Ä–µ–∑—É–ª—å—Ç–∞—Ç! –ú–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ –≤ –æ–±—ã—á–Ω–æ–º —Ä–µ–∂–∏–º–µ."
        color = "#4CAF50"
    elif prediction > 40:
        status = "üü° –°–†–ï–î–ù–ò–ô"
        advice = "–ó–∞—Ä—è–¥ –Ω–∞ —Å—Ä–µ–¥–Ω–µ–º —É—Ä–æ–≤–Ω–µ. –†–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è —ç–Ω–µ—Ä–≥–æ—Å–±–µ—Ä–µ–≥–∞—é—â–∏–π —Ä–µ–∂–∏–º."
        color = "#FFC107"
    elif prediction > 15:
        status = "üü† –ù–ò–ó–ö–ò–ô"
        advice = "–ó–∞—Ä—è–¥ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏ –Ω–∏–∑–∫–∏–π! –ü–æ–¥–∫–ª—é—á–∏—Ç–µ –∑–∞—Ä—è–¥–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ."
        color = "#FF9800"
    else:
        status = "üî¥ –ö–†–ò–¢–ò–ß–ï–°–ö–ò–ô"
        advice = "–ù–ï–ú–ï–î–õ–ï–ù–ù–û –ø–æ–¥–∫–ª—é—á–∏—Ç–µ –∑–∞—Ä—è–¥–Ω–æ–µ —É—Å—Ç—Ä–æ–π—Å—Ç–≤–æ!"
        color = "#F44336"
    
    # –†–∞—Å—á–µ—Ç –≤—Ä–µ–º–µ–Ω–∏ —Ä–∞–±–æ—Ç—ã
    if prediction > 50:
        hours_left = prediction / 4.5
    elif prediction > 20:
        hours_left = prediction / 4.0
    else:
        hours_left = prediction / 3.5
    
    hours_left = max(0.5, min(24, hours_left))
    
    # –°–æ–∑–¥–∞–Ω–∏–µ HTML –æ—Ç—á–µ—Ç–∞
    html_report = f"""
    <div style="padding: 20px; border-radius: 10px; background-color: #f8f9fa; border-left: 5px solid {color};">
        <h2 style="color: {color}; margin-top: 0;">üîã –†–ï–ó–£–õ–¨–¢–ê–¢ –ü–†–ï–î–°–ö–ê–ó–ê–ù–ò–Ø</h2>
        
        <div style="display: flex; align-items: center; margin-bottom: 20px;">
            <div style="font-size: 48px; font-weight: bold; color: {color}; margin-right: 20px;">
                {prediction:.1f}%
            </div>
            <div>
                <h3 style="margin: 0; color: {color};">{status} –ó–ê–†–Ø–î</h3>
                <p style="margin: 5px 0 0 0; color: #666;">–û—Å—Ç–∞—Ç–æ—á–Ω—ã–π –∑–∞—Ä—è–¥ –∫ –∫–æ–Ω—Ü—É –¥–Ω—è</p>
            </div>
        </div>
        
        <div style="background-color: white; padding: 15px; border-radius: 8px; margin-bottom: 15px;">
            <h4 style="margin-top: 0;">üìã –°–í–û–î–ö–ê:</h4>
            <p><strong>‚åõ –ü—Ä–∏–º–µ—Ä–Ω–æ–µ –≤—Ä–µ–º—è —Ä–∞–±–æ—Ç—ã:</strong> {hours_left:.1f} —á–∞—Å–æ–≤</p>
            <p><strong>üí° –†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è:</strong> {advice}</p>
        </div>
        
        <div style="background-color: white; padding: 15px; border-radius: 8px;">
            <h4 style="margin-top: 0;">üìä –í–õ–ò–Ø–ù–ò–ï –§–ê–ö–¢–û–†–û–í:</h4>
            <p><strong>–ù–∞—á–∞–ª—å–Ω—ã–π –∑–∞—Ä—è–¥:</strong> {initial_battery_level:.1f}%</p>
            <p><strong>–§–æ–Ω–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã:</strong> -{background_processes*0.3:.1f}% –∫ —Ä–∞—Å—Ö–æ–¥—É</p>
            <p><strong>–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU:</strong> -{cpu_usage_percent*0.2:.1f}% –∫ —Ä–∞—Å—Ö–æ–¥—É</p>
            <p><strong>–Ø—Ä–∫–æ—Å—Ç—å —ç–∫—Ä–∞–Ω–∞:</strong> -{screen_brightness*0.1:.1f}% –∫ —Ä–∞—Å—Ö–æ–¥—É</p>
        </div>
    </div>
    """
    
    return html_report

# –°–æ–∑–¥–∞–Ω–∏–µ Gradio –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
print("\nüé® –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–æ–≥–æ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞...")

# –£–ø—Ä–æ—â–µ–Ω–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –±–µ–∑ —Å–ª–æ–∂–Ω—ã—Ö –≤–ª–æ–∂–µ–Ω–∏–π
demo = gr.Blocks(title="üîã –£–º–Ω—ã–π –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å –∑–∞—Ä—è–¥–∞ –±–∞—Ç–∞—Ä–µ–∏")

with demo:
    gr.Markdown("# üîã –£–º–Ω—ã–π –ø—Ä–µ–¥—Å–∫–∞–∑–∞—Ç–µ–ª—å –∑–∞—Ä—è–¥–∞ –∞–∫–∫—É–º—É–ª—è—Ç–æ—Ä–∞")
    gr.Markdown("–ù–µ–π—Ä–æ–Ω–Ω–∞—è —Å–µ—Ç—å –ø—Ä–µ–¥—Å–∫–∞–∑—ã–≤–∞–µ—Ç –æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π –∑–∞—Ä—è–¥ –≤–∞—à–µ–≥–æ —Å–º–∞—Ä—Ç—Ñ–æ–Ω–∞ –∫ –∫–æ–Ω—Ü—É –¥–Ω—è")
    
    with gr.Row():
        with gr.Column():
            initial_battery = gr.Slider(
                minimum=20, maximum=100, value=85, step=1,
                label="–ù–∞—á–∞–ª—å–Ω—ã–π –∑–∞—Ä—è–¥ –±–∞—Ç–∞—Ä–µ–∏ (%)"
            )
            
            device_age = gr.Slider(
                minimum=1, maximum=48, value=12, step=1,
                label="–í–æ–∑—Ä–∞—Å—Ç —É—Å—Ç—Ä–æ–π—Å—Ç–≤–∞ (–º–µ—Å—è—Ü–µ–≤)"
            )
            
            apps_count = gr.Slider(
                minimum=10, maximum=200, value=50, step=5,
                label="–ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π"
            )
            
            background_processes = gr.Slider(
                minimum=0, maximum=100, value=30, step=5,
                label="–§–æ–Ω–æ–≤—ã–µ –ø—Ä–æ—Ü–µ—Å—Å—ã (%)"
            )
        
        with gr.Column():
            network_activity = gr.Slider(
                minimum=0, maximum=100, value=40, step=5,
                label="–°–µ—Ç–µ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å (%)"
            )
            
            cpu_usage = gr.Slider(
                minimum=0, maximum=100, value=45, step=5,
                label="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ CPU (%)"
            )
            
            screen_brightness = gr.Slider(
                minimum=0, maximum=100, value=60, step=5,
                label="–Ø—Ä–∫–æ—Å—Ç—å —ç–∫—Ä–∞–Ω–∞ (%)"
            )
            
            wifi_usage = gr.Slider(
                minimum=0, maximum=100, value=50, step=5,
                label="–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ Wi-Fi (%)"
            )
    
    predict_btn = gr.Button("üîÆ –ü–†–ï–î–°–ö–ê–ó–ê–¢–¨ –ó–ê–†–Ø–î", variant="primary")
    
    output_html = gr.HTML(
        label="–†–µ–∑—É–ª—å—Ç–∞—Ç",
        value="<div style='text-align: center; padding: 40px; color: #666;'><h3>üëÜ –í–≤–µ–¥–∏—Ç–µ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –∏ –Ω–∞–∂–º–∏—Ç–µ –∫–Ω–æ–ø–∫—É</h3></div>"
    )
    
    # –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
    gr.Markdown("### üí° –ü–†–ò–ú–ï–†–´ –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Ø")
    
    examples = gr.Examples(
        examples=[
            [85, 12, 50, 30, 40, 45, 60, 50],
            [95, 6, 30, 20, 20, 30, 40, 30],
            [70, 24, 80, 60, 70, 65, 80, 70]
        ],
        inputs=[
            initial_battery, device_age, apps_count,
            background_processes, network_activity, cpu_usage,
            screen_brightness, wifi_usage
        ],
        outputs=[output_html],
        fn=predict_battery,
        label="–ü—Ä–∏–º–µ—Ä—ã"
    )
    
    # –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –º–æ–¥–µ–ª–∏
    gr.Markdown(f"""
    ### üìä –ò–ù–§–û–†–ú–ê–¶–ò–Ø –û –ú–û–î–ï–õ–ò
    
    <div style="background-color: #f0f2f6; padding: 15px; border-radius: 8px;">
        <p><strong>üìä –ú–µ—Ç—Ä–∏–∫–∏ –º–æ–¥–µ–ª–∏:</strong></p>
        <ul>
            <li>MAE: {mae:.2f}%</li>
            <li>RMSE: {rmse:.2f}%</li>
            <li>R¬≤ Score: {r2:.4f}</li>
        </ul>
        
        <p><strong>üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞:</strong></p>
        <ul>
            <li>–°–∫—Ä—ã—Ç—ã–µ —Å–ª–æ–∏: 128-64-32 –Ω–µ–π—Ä–æ–Ω–æ–≤</li>
            <li>–ê–∫—Ç–∏–≤–∞—Ü–∏—è: ReLU</li>
            <li>Dropout: 30%</li>
            <li>–û–ø—Ç–∏–º–∏–∑–∞—Ç–æ—Ä: Adam</li>
        </ul>
    </div>
    """)
    
    # –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫–Ω–æ–ø–∫–∏
    predict_btn.click(
        fn=predict_battery,
        inputs=[
            initial_battery, device_age, apps_count,
            background_processes, network_activity, cpu_usage,
            screen_brightness, wifi_usage
        ],
        outputs=[output_html]
    )

print("\n‚úÖ –ò–Ω—Ç–µ—Ä—Ñ–µ–π—Å —Å–æ–∑–¥–∞–Ω —É—Å–ø–µ—à–Ω–æ!")

# –ó–∞–ø—É—Å–∫ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞
try:
    # –î–ª—è Google Colab
    demo.launch(debug=True, share=True)
except Exception as e:
    print(f"‚ö†Ô∏è  –û—à–∏–±–∫–∞ –∑–∞–ø—É—Å–∫–∞ –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞: {e}")
    print("‚ÑπÔ∏è  –ü—Ä–æ–¥–æ–ª–∂–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ...")

# %% [markdown]
# ## üíæ 8. –°–û–•–†–ê–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í

# %%
print("\n" + "="*60)
print("üíæ –°–û–•–†–ê–ù–ï–ù–ò–ï –†–ï–ó–£–õ–¨–¢–ê–¢–û–í –ò –ú–û–î–ï–õ–ò")
print("="*60)

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏
print("\nüíæ –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –º–æ–¥–µ–ª–∏...")
model.save('battery_prediction_model.h5')

# –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –æ–±—É—á–µ–Ω–∏—è
training_history = {
    'metrics': {
        'test_mae': float(mae),
        'test_rmse': float(rmse),
        'test_r2': float(r2)
    },
    'history': {
        'loss': history.history['loss'],
        'val_loss': history.history['val_loss'],
        'mae': history.history['mae'],
        'val_mae': history.history['val_mae']
    }
}

with open('training_history.json', 'w') as f:
    json.dump(training_history, f, indent=4)

print("\n‚úÖ –í—Å–µ —Ñ–∞–π–ª—ã —É—Å–ø–µ—à–Ω–æ —Å–æ—Ö—Ä–∞–Ω–µ–Ω—ã:")
print("   1. battery_prediction_model.h5    - –ú–æ–¥–µ–ª—å –≤ —Ñ–æ—Ä–º–∞—Ç–µ H5")
print("   2. battery_scaler.pkl             - Scaler –¥–ª—è –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏—è")
print("   3. training_history.json          - –ò—Å—Ç–æ—Ä–∏—è –æ–±—É—á–µ–Ω–∏—è")

# –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞
print("\nüì¶ –°–æ–∑–¥–∞–Ω–∏–µ –∞—Ä—Ö–∏–≤–∞ –¥–ª—è —Å–∫–∞—á–∏–≤–∞–Ω–∏—è...")
!zip -r battery_model_project.zip \
    battery_prediction_model.h5 \
    battery_scaler.pkl \
    training_history.json

# %% [markdown]
# ## üéØ 9. –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ú–û–î–ï–õ–ò

# %%
print("\n" + "="*60)
print("üéØ –¢–ï–°–¢–ò–†–û–í–ê–ù–ò–ï –ú–û–î–ï–õ–ò")
print("="*60)

# –ü—Ä–æ—Å—Ç–æ–π —Ç–µ—Å—Ç
print("\nüß™ –¢–µ—Å—Ç 1: –ü—Ä–æ–≤–µ—Ä–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥–µ–ª–∏...")

try:
    # –ó–∞–≥—Ä—É–∑–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω–æ–π –º–æ–¥–µ–ª–∏
    loaded_model = tf.keras.models.load_model('battery_prediction_model.h5')
    print("‚úÖ –ú–æ–¥–µ–ª—å —É—Å–ø–µ—à–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–∞!")
    
    # –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
    test_input = np.array([[85, 12, 50, 30, 40, 45, 60, 50]])
    test_scaled = scaler.transform(test_input)
    test_prediction = loaded_model.predict(test_scaled, verbose=0)[0][0]
    
    print(f"‚úÖ –¢–µ—Å—Ç–æ–≤–æ–µ –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ: {test_prediction:.1f}%")
    
except Exception as e:
    print(f"‚ùå –û—à–∏–±–∫–∞: {e}")

print("\n" + "="*60)
print("‚úÖ –í–°–ï –¢–ï–°–¢–´ –ü–†–û–ô–î–ï–ù–´!")
print("="*60)

# –§–∏–Ω–∞–ª—å–Ω–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ
print("\n" + "üéØ" * 30)
print("   –í–ê–®–ê –ú–û–î–ï–õ–¨ –ì–û–¢–û–í–ê –ö –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ!")
print("üéØ" * 30)

# –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é
print("""
üìå –ò–ù–°–¢–†–£–ö–¶–ò–Ø –ü–û –ò–°–ü–û–õ–¨–ó–û–í–ê–ù–ò–Æ:

1. –î–ª—è –Ω–æ–≤—ã—Ö –ø—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–π –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ Gradio –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
2. –ß—Ç–æ–±—ã —Å–∫–∞—á–∞—Ç—å –º–æ–¥–µ–ª—å, –Ω–∞–π–¥–∏—Ç–µ —Ñ–∞–π–ª—ã –≤ –ø–∞–Ω–µ–ª–∏ —Å–ª–µ–≤–∞ (Files)
3. –î–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ –≤ –¥—Ä—É–≥–∏–µ –ø—Ä–æ–µ–∫—Ç—ã:

import tensorflow as tf
import pickle
import numpy as np

# –ó–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥–µ–ª–∏ –∏ scaler
model = tf.keras.models.load_model('battery_prediction_model.h5')
with open('battery_scaler.pkl', 'rb') as f:
    scaler = pickle.load(f)

# –ü—Ä–µ–¥—Å–∫–∞–∑–∞–Ω–∏–µ
def predict_battery(params):
    params_array = np.array([params])
    params_scaled = scaler.transform(params_array)
    prediction = model.predict(params_scaled, verbose=0)
    return prediction[0][0]

# –ü—Ä–∏–º–µ—Ä
result = predict_battery([85, 12, 50, 30, 40, 45, 60, 50])
print(f"–û—Å—Ç–∞—Ç–æ—á–Ω—ã–π –∑–∞—Ä—è–¥: {result:.1f}%")
""")

print("\nüéâ –ü—Ä–æ–µ–∫—Ç —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω!")
